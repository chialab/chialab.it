@import '@chialab/dna-map-scroller/style';
@import '@chialab/dna-map/style';
@import '@chialab/dna-story-scroller/style';
@import '@chialab/dna-zoom-panel/style';

.journey-page {
    margin-top: 0;
}

skua-map-scroller {
    --shadow-color: rgba(0, 0, 0, 0.5);
    --steps-resized-width: var(--map-scroller-steps-width);
    --steps-max-width: calc(100vw - var(--map-scroller-left-offset) - var(--map-scroller-right-padding));

    position: relative;
    display: block;
    width: 100%;
    height: 100vh;
    overflow: auto;
}

skua-map-scroller .map-scroller__map {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 0;
    width: 100%;
    height: 100%;
}

skua-map-scroller .map-scroller__map dna-map {
    width: 100%;
    height: 100%;
}

skua-map-scroller .map-scroller__map dna-map [marker-symbol] {
    fill: var(--marker-primary-fill, black);
}

skua-map-scroller .map-scroller__map dna-map [marker-symbol].current {
    --marker-primary-fill: var(--color-accent);
}

skua-map-scroller .map-scroller__map dna-map [marker-symbol] text.marker-index {
    font-family: var(--font-mono);
    font-size: var(--font-size-3);
    font-weight: var(--weight-bold);
    fill: black;
    dominant-baseline: text-before-edge;
}

skua-map-scroller dna-story-scroller {
    position: relative;
    z-index: 1;
    width: fit-content;
    height: 100%;
    margin-left: var(--map-scroller-left-margin);
    padding-right: var(--map-scroller-right-padding);
    padding-left: var(--map-scroller-left-padding);
    overflow: auto;
    direction: rtl; /* per mettere la scrollbar a sinistra */
    text-align: left;
}

skua-map-scroller dna-story-scroller::-webkit-scrollbar {
    width: var(--scrollbar-width);
}

skua-map-scroller dna-story-scroller::-webkit-scrollbar-thumb {
    --scrollbar-thumb-bg: black;

    background: repeating-linear-gradient(transparent, transparent 0 6px, var(--scrollbar-thumb-bg) 7px 10px);
}

skua-map-scroller dna-story-scroller::-webkit-scrollbar-thumb:hover {
    --scrollbar-thumb-bg: var(--color-neutral);

    cursor: pointer;
}

@supports not selector(.z-scrollbar::-webkit-scrollbar-track) {
    skua-map-scroller dna-story-scroller {
        scrollbar-color: black transparent;
    }
}

skua-map-scroller .story-scroller__contents {
    position: relative;
    direction: ltr; /* rimette il contenuto in direzione normale */
}

.story-scroller__contents dna-map-scroller-step {
    width: var(--steps-resized-width, var(--map-scroller-steps-width));
    min-width: var(--map-scroller-steps-width);
    max-width: var(--steps-max-width);
    margin-bottom: 15vh;
    box-shadow: 0 16px 16px 0 var(--shadow-color);
}

.story-scroller__contents dna-map-scroller-step .map-scroller-item dna-slideshow {
    width: 100%;
    max-height: var(--map-scroller-steps-width);
}

.story-scroller__contents dna-map-scroller-step .map-scroller-item app-dialog dna-slideshow {
    height: 100%;
    max-height: 100%;
}

.story-scroller__contents dna-map-scroller-step .map-scroller-item :is(img, video) {
    display: block;
    width: 100%;
}

.story-scroller__contents dna-map-scroller-step .map-scroller-item img.clickable {
    cursor: pointer;
}

dna-map-scroller-step .item-content {
    --block-padding: calc(var(--padding) * 5);
    --padding-left: calc(var(--padding) * 8);
    --padding-right: calc(var(--padding) * 4);

    padding: var(--block-padding) var(--padding-right) var(--block-padding) var(--padding-left);
}

dna-map-scroller-step .item-content .post-link:hover {
    text-decoration: underline;
}

dna-map-scroller-step .item-content .journey-title {
    margin-bottom: 128px;
}

dna-map-scroller-step .item-content [data-placeholder] {
    /* placeholder a filo coi bordi della card */
    margin-top: 1rem;
    margin-right: calc(var(--padding-right) * -1);
    margin-bottom: 1rem;
    margin-left: calc(var(--padding-left) * -1);
}

dna-map-scroller-step .item-content .index {
    color: var(--color-accent);
    text-decoration-color: var(--color-accent);
}

dna-map-scroller-step .item-content .title {
    font-weight: 600;
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) {
    font-family: var(--font-serif);
    line-height: 1.5;
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) :is(h1, h2, h3, h4, h5, h6) {
    font-family: var(--font-sans);
    font-weight: 600;
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) :is(h1, h2) {
    font-size: var(--font-size-3);
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) blockquote {
    width: fit-content;
    margin: 1.5rem 0;
    margin-left: 4.5rem;
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) blockquote.short-quote {
    font-family: var(--font-serif);
    font-size: 1.25rem;
    font-style: italic;
    border-top: 1px solid currentcolor;
    border-bottom: 1px solid currentcolor;
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) blockquote :is(h2, h3, h4, h5, h6) {
    font-size: var(--font-size-2);
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) blockquote .quote-author {
    display: block;
    margin-top: 1.5rem;
    font-family: var(--font-sans);
    font-size: 0.875rem;
    font-style: normal;
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) blockquote:not(.short-quote) {
    position: relative;
    color: var(--color-text-neutral);
    font-family: var(--font-sans);
}

dna-map-scroller-step .item-content :is(.item-description, .item-body) blockquote:not(.short-quote)::before {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    left: -20px;
    width: 12px;
    background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 100" preserveAspectRatio="none"%3E%3Cline x1="0.5" y1="0" x2="11.5" y2="100" stroke="black" stroke-width="1" /%3E%3C/svg%3E');
}

/* titolo citazione */
dna-map-scroller-step .item-content :is(.item-description, .item-body) blockquote:not(.short-quote) strong {
    margin-bottom: 0.5rem;
    font-weight: var(--weight-bold);
}

skua-map-scroller .resize-handle {
    content: '';
    position: fixed;
    top: 230px;
    left: calc(var(--map-scroller-left-offset) + var(--steps-resized-width));
    z-index: 1;
    display: flex;
    align-items: center;
    padding: 0;
    background: none;
    border: none;
    transform: translateX(-50%);
    cursor: col-resize;
    touch-action: none;
}

body:has(app-dialog dna-dialog[open]) skua-map-scroller .resize-handle {
    z-index: 0;
}

skua-map-scroller .resize-handle dna-icon {
    display: block;
    width: 30px;
    height: auto;
}

@media (width < 768px) {
    skua-map-scroller {
        --steps-max-width: 100vw;
        --map-scroller-steps-height: 75vh;
        --steps-resized-height: var(--map-scroller-steps-height);
    }

    skua-map-scroller dna-story-scroller {
        width: 100%;
        height: var(--steps-resized-height, var(--map-scroller-steps-height));
        margin-left: 0;
        padding-right: 0;
        padding-left: 0;
        direction: ltr;
        box-shadow: 0 16px 16px 0 var(--shadow-color);
    }

    skua-map-scroller dna-story-scroller::-webkit-scrollbar {
        display: none;
    }

    .story-scroller__contents dna-map-scroller-step {
        width: var(--map-scroller-steps-width);
        min-width: 100%;
        margin-bottom: var(--gap);
    }

    .story-scroller__contents dna-map-scroller-step:last-of-type {
        margin-bottom: 0;
    }

    dna-map-scroller-step .item-content {
        --block-padding: calc(var(--padding) * 4);
        --padding-left: calc(var(--padding) * 3);
        --padding-right: calc(var(--padding) * 3);

        padding: var(--padding-right) var(--block-padding) var(--padding-left);
    }

    dna-map-scroller-step:first-of-type .item-content {
        padding-top: 142px; /* fixed header height (76) + greater padding top */
    }

    dna-map-scroller-step .item-content .journey-title {
        margin-bottom: calc(var(--padding) * 3);
    }

    skua-map-scroller .resize-handle {
        top: var(--steps-resized-height);
        right: 2rem;
        left: auto;
        transform: rotateZ(90deg);
        transform-origin: top;
        cursor: row-resize;
    }
}

@media (width >= 768px) and (width < 1024px) {
    dna-map-scroller-step .item-content {
        --padding-left: calc(var(--padding) * 4);
    }
}

@media (width >= 768px) {
    skua-topbar {
        --left-offset: calc(var(--map-scroller-left-offset) + var(--map-scroller-steps-width)) !important;
    }

    skua-map-scroller dna-story-scroller dna-map-scroller-step:last-of-type {
        margin-bottom: 50vh;
    }
}
